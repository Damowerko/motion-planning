- model: gpg
  operations:
    pretrain:
      main: scripts/main pretrain
      output-scalars: off
      flags-dest: args
      flags-import: all
      sourcecode:
        select:
          - "*.py"
          - include:
              dir: scripts
          - include:
                dir: src
    train:
      main: scripts/main train
      output-scalars: off
      flags-dest: args
      flags-import: all
      sourcecode:
        select:
          - "*.py"
          - include:
              dir: scripts
          - include:
              dir: src
      requires:
        - operation: pretrain
    test:
      main: scripts/main test
      output-scalars: off
      flags-dest: args
      flags-import: all
      sourcecode:
        select:
          - "*.py"
          - include:
              dir: scripts
          - include:
              dir: src
      requires:
        - operation: ${target}
          name: model
      flags:
        target:
          choices: [pretrain, train]
          default: train
          arg-skip: yes
  resources:
    data:
      - file: data/
        target-type: link
    logs:
      - file: logs/
        target-type: link
